<!DOCTYPE html>
<html>
<head>
<title>Images to PDF</title>
<style>
body{background:#0f2027;color:#fff;font-family:Segoe UI}
.container{max-width:600px;margin:70px auto;background:#203a43;padding:30px;border-radius:16px}
.back{color:#38bdf8;text-decoration:none}
.file-box{margin:20px 0;padding:20px;border:2px dashed #38bdf8;border-radius:14px;text-align:center;cursor:pointer}
input{display:none}
.file-item{background:rgba(255,255,255,.08);padding:12px;border-radius:10px;margin-bottom:10px;display:flex;justify-content:space-between}
button{width:100%;padding:14px;border:none;border-radius:12px;background:#38bdf8;font-weight:bold;cursor:pointer}
.download-again{display:none;background:#22c55e;margin-top:12px}
</style>
</head>
<body>

<div class="container">
<a class="back" href="/">‚Üê Back</a>
<h2>Images ‚Üí PDF</h2>

<label class="file-box">
Select Images
<input type="file" id="fileInput" multiple accept="image/*">
</label>

<div id="fileList"></div>

<button onclick="convert()">Convert & Download</button>
<button id="downloadBtn" class="download-again">Download Again</button>
</div>

<script>
const input=document.getElementById("fileInput");
const list=document.getElementById("fileList");
let dt=new DataTransfer(), lastUrl=null;

input.addEventListener("change",()=>{
  [...input.files].forEach(f=>dt.items.add(f));
  input.files=dt.files;
  render();
});

function render(){
  list.innerHTML="";
  [...dt.files].forEach((f,i)=>{
    list.innerHTML+=`<div class="file-item">üñº ${f.name}
    <button onclick="remove(${i})">‚ùå</button></div>`;
  });
}
function remove(i){
  dt.items.remove(i);
  input.files=dt.files;
  render();
}
function forceDownload(url,name){
  const a=document.createElement("a");
  a.href=url;a.download=name;
  document.body.appendChild(a);a.click();a.remove();
}
async function convert(){
  if(!dt.files.length)return alert("Select images");
  const fd=new FormData();
  [...dt.files].forEach(f=>fd.append("files",f));
  const res=await fetch("/api/pdf/from-images",{method:"POST",body:fd});
  const blob=await res.blob();
  const url=URL.createObjectURL(blob);
  forceDownload(url,"images.pdf");
  lastUrl=url;
  downloadBtn.style.display="block";
  downloadBtn.onclick=()=>forceDownload(lastUrl,"images.pdf");
}
</script>
</body>
</html>
